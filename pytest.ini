[pytest]
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
addopts = 
    -v
    --strict-markers
    --cov=src
    --cov-report=term-missing
    --cov-report=html
    --cov-fail-under=80
markers =
    slow: marks tests as slow
    unit: marks tests as unit tests (fast, no external dependencies)
    integration: marks tests as integration tests (require database/external services)
    asyncio: marks tests as async tests
    gemini_api: marks tests that require real Gemini API calls

# Async support
asyncio_mode = auto

[tool:pytest]
# When running only integration tests, coverage is not required
# Use: pytest -m integration --no-cov

# Environment Variables:
# USE_REAL_AI=true - Use real Google Gemini AI calls (slow, requires API key)
# USE_REAL_AI=false (default) - Mock AI calls for fast testing
# 
# Test Execution Patterns:
#   pytest                          # Run all tests (unit + integration)
#   pytest -m unit                  # Run only unit tests (fast, for CI builds)
#   pytest -m integration           # Run only integration tests (slow, requires DB)
#   pytest -m "not gemini_api"       # Run tests without Gemini API calls
#   USE_REAL_AI=true pytest -m gemini_api  # Run only Gemini API tests with real API
#   USE_REAL_AI=true pytest          # Run everything including Gemini API tests
# 
# Examples:
#   pytest                          # Fast tests with mocked AI
#   USE_REAL_AI=true pytest         # Slow tests with real AI
#   $env:USE_REAL_AI="true"; pytest # Windows PowerShell

